<!doctype html>
<html ng-app="resourceApp">
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.3.15/angular-resource.js"></script>
    <script src="/js/controllers.js"></script>
  </head>
  <body>
    <h2>Resource</h2>
    <div ng-controller="resourceListController as resourceList">
      <span>All {{resourceList.resources.length}} resources</span>
      <ul class="unstyled">
        <li ng-repeat="resource in resourceList.resources"> 
          <span><b>{{resource.name}}</b></span>
          <span>{{resource.target}}</span>
          <span><a href='' ng-model="collapsed" ng-click="collapsed=!collapsed">variants: {{resource.variants.length}}</a></span>
          <a href="" ng-click="resourceList.deleteResource($index)">del</a>
          <div ng-show="collapsed">
            <ul>
              <li ng-repeat="variant in resource.variants track by $index">
                {{variant}}
                <a href="" ng-click="resourceList.deleteVariant($parent.$index,$index)">del</a>
              </li>
            </ul>
            <form ng-submit="resourceList.addVariant($index)">
                <input type="text" ng-model="resourceList.newVariant[$index]" size="10"
                 placeholder="variant">
                <input class="btn-primary" type="submit" value="add">
            </form>
          </div>
        </li>
      </ul>
      <form ng-submit="resourceList.addResource()">
        <input type="text" ng-model="resourceList.name" size="15"
               placeholder="name">
        <input type="text" ng-model="resourceList.target" size="15"
               placeholder="target">
        <input class="btn-primary" type="submit" value="add">
      </form>
      <a href='' ng-click="resourceList.save()">save</a>
    </div>
  </body>
</html>